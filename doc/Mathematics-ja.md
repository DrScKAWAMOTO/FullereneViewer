# FullereneViewer(フラーレンビューア)
## 数学

### NoA (number of automorphisms)

　fullerene の炭素集合から自身への錯体同型写像の数です。

　これは対称軸を表示した場合の軸の数とは違います。  
　例えば C76 は NoA=4 ですが、対称軸の数は３本です。これは群論で言うと、位数２の巡回群の直積群は、元の数は４ですが、位数２の元は３個であることに相当します。残り１個は単位元です。

　他の例としては C80 NoA=6 のフラーレンは、位数が２の対称軸が３本と、位数が３の対称軸が１本です。これは群論で言うと、S3 という群に相当します。位数が２の対称軸３本にはそれぞれ位数が２の元 (12) と (13) と (23) が対応し、位数が３の対称軸１本には位数が３の元 (123) と (132) の二つが対応し、残る１個は単位元です。

　NoA は、ca-generator や ca-uniq で出力することができます。

### Pdd (pentagon distances distribution)

　フラーレンの五員環距離の分布です。

　フラーレンの１２個の五員環のうち任意の２個を取り出し、距離を調べます。任意の異なる２個の五員環の距離とは、その２個の五員環を繋ぐボンドからなるパスのうち、一番短いパスを構成するボンドの数のことです。同じ五員環の距離は０とします。１２個の五員環の組み合わせは全部で１４４通りあるので、１４４個の距離が得られます。  
　次に、同じ距離の組み合わせをまとめて数をかぞえます。距離０の数はどのフラーレンでも丁度１２個あります。距離１以上はフラーレンによってまちまちです。
　最後に距離０の数からはじめてセミコロンで区切って数を並べていきます。セミコロンや数は全て半角キャラクタ(ASCIIキャラクタ)で書きます。数が０個の距離のところは０と書きます。最大距離の数に到達した時点で並べ終わりです。
　例えばフラーレン C60 の場合は、 `12;60;0;0;60;0;0;12` です。例えばフラーレン C70 の場合は、 `12;40;10;20;20;20;20;0;2` です。

　Pdd は、ca-char --pentagon-distances で出力することができます。

　フラーレンの五員環距離の分布は、フラーレンの不変量となります。鏡像自己同型でないフラーレンの場合は、自身の五員環距離の分布と鏡像の五員環距離の分布は一致します。

　この不変量は完全ではありません。

C84 (NoA=12,MirrorSymmetric,Pdd=12;24;12;24;24;12;24;0;0;12) S3-5b6d5b6c
C84 (NoA=6,MirrorSymmetric,Pdd=12;24;12;24;24;12;24;0;0;12) S2-6c5b6b5b6d5b6c

　この二つは同型ではありません(NoAが違います)が、Pdd および炭素数が一致します。

　五員環分布のようなものを定義できれば、これは完全な不変量になり得ると私は信じています。しかし、今のところ適切に分布を表現する方法を私は持ち合わせていません。

### 五員環のクラスタリング階層

　五員環分布を表す量として、五員環のクラスタリング階層を考えることができます。
　おおざっぱにいうと、五員環同士の距離(0を除く)のうち、一番小さな距離で五員環をクラスタリング(グループ分け)します。このグループ同士の距離を、適当な代表元同士の距離のうち最小値とします。ただし、同一グループ間の距離は0とします。続いてグループ同士の距離(0を除く)のうち、一番小さな距離でグループをクラスタリング(更におおぐくりのグループ分け)します。このグループ同士の距離を、、、、と再帰的にクラスタリングの階層を作っていって、一つのグループになってしまったらそこでクラスタリング作業を終了します。
　五員環やグループ一つ一つを頂点と考え、クラスタリングされる関係を辺と考えると、樹形図画得られます。この樹形図を「五員環のクラスタリング階層」と呼びます。

　クラスタリング階層は、まだ、一段目しか実装していません。一段目だけなら ca-char --pentagon-matrix で表示できます。

　五員環分布の量を抽出したものが Pdd だとすれば、五員環分布の形状を抽出したものがクラスタリング階層ですので、五員環のクラスタリング階層と Pdd を組み合わせれば、もしかしたら完全な不変量が得られるかもしれません。

### 最小表現

　まず、フラーレンの表現について。

　フラーレンのカーボンを任意に一つとり、そこに繋がっているボンドも任意に一つとります。フラーレンの表を上空と考え、フラーレンのカーボンの表面に小人が乗っていると思って下さい。小人が向いている方向は先ほどのボンドを背にします。  
　ここからスタートして、いわゆる左手法を使って、全カーボンを渡り歩いていきます。  
　渡り歩いて進んだ先が初めて訪れたカーボンであれば、その次は左側に進みます。  
　既に到達したことのあるカーボンには進みません。かわりに右側に進みます。  
　左側も右側も進み終わっていたならバックします。但し、バックした先は既に訪れたことのあるカーボンですが、この場合は気にせずバックして構いません。  
　こうやって全てのカーボンを訪れたら、一番最初のカーボンに戻ってきます。

　フラーレンの表現とは、このような進み方の履歴のことです。  
　具体的には文字列で表します。  
　最初は空の文字列からはじまり、左側に進んだ時には 'L' を文字列の最後に追加し、右側に進んだ時には 'R' を文字列の最後に追加し、バックした時には 'b' を文字列の最後に追加します。  
　こうやって出来た文字列がフラーレンの表現です。

　フラーレンの表現は、最初にとったカーボンやボンドの取り方に依存します。

　このようなカーボンやボンドの全ての取り方で得られた表現のうち、文字列比較として一番小さな表現を、最小表現と呼びます。

　フラーレンの最小表現は、カーボンやボンドの取り方に依存しません。

　フラーレンの最小表現はフラーレンの完全不変量です。

　フラーレンビューアなどのプログラムの中では、フラーレンの最小表現は圧縮した文字列で保持されます。最小の判定方法も、圧縮された文字列の方で判定されます。圧縮方法の説明については割愛します。 

### 生成式

　フラーレンを生成する方法を記述した式です。引数にこれを指定して FullereneViewer を起動すると、[フラーレン指定]メニュー以外のフラーレンも表示することができます。

* S1-5b6c5b6b5b

    対称度の高いフラーレンを生成します。最初の `S1` は、一つの五員環と、そのまわりに５つの六員環を並べた複体を生成の開始状態とすることを表します。ハイフンに続き、開始状態のまわりに五員環と六員環をどのような順番で並べるかを表します。数字の `5` は五員環を、数字の `6` は六員環を表し、それぞれに続くアルファベットは、`a` を 0、 `b` を 1 ... `z` を 25 とみる26進数と思って得られる数字は、直前の環の重複度を表します。上記例だと、五員環六員環六員環五員環六員環五員環の順に並べるという意味です。ただし、ハイフン移行の並べ方は、常に、開始状態の複体の中心を軸として対称になるようにします。上記例だと、五員環五員環五員環五員環五員環六員環六員環六員環六員環六員環六員環六員環六員環六員環六員環五員環五員環五員環五員環五員環六員環六員環六員環六員環六員環五員環の順です。

* S2-6c5b6c5b6b

    対称度の高いフラーレンを生成します。最初の `S2` は、一つの六員環と、そのまわりに３つの五員環を一つおきに並べ、更に五員環を完全に覆いつくすように六員環を並べた複体を生成の開始状態とすることを表します。ハイフンに続く英数字については前出の説明通りです。

* S3-5b6c5b6c

    対称度の高いフラーレンを生成します。最初の `S3` は、一つの六員環と、そのまわりに６つの六員環を並べた複体を生成の開始状態とすることを表します。ハイフンに続く英数字については前出の説明通りです。

* S4-6b5c6b5b6b

    対称度の高いフラーレンを生成します。最初の `S4` は、三つの六員環と、そのまわりの凹んでいる３箇所に３つの五員環を並べ、更に五員環を完全に覆いつくすように六員環を並べた複体を生成の開始状態とすることを表します。ハイフンに続く英数字については前出の説明通りです。

* A1-5b6b5b6b5b6b5b6b5b6c5b6b5b6b5b6b5b6b5b6f5b

    対称度は気にせずフラーレンを生成します。最初の `A1` は、一つの五員環と、そのまわりに５つの六員環を並べた複体を生成の開始状態とすることを表します。ハイフンに続き、開始状態のまわりに五員環と六員環をどのような順番で並べるかを表します。数字や英字記号の意味は前出の説明通りです。上記例だと、五員環六員環五員環六員環五員環六員環五員環六員環五員環六員環六員環五員環六員環五員環六員環五員環六員環五員環六員環五員環六員環六員環六員環六員環六員環五員環の順に並べるという意味です。

* T8,2,6

    TODO 説明をここに書きます。

* T5,5,3-5b6b5b6b5b6b5b6b5b6b5c6b5b6b5b6b5b6c5c

    TODO 説明をここに書きます。

* Y

    TODO 説明をここに書きます。

### 現状
　対称性の高いフラーレンは、`ca->fill_n_polygons_around_carbons_closed_to_center_and_pentagons(val, num);` の組み合わせで、対称性の低いフラーレンは、`ca->fill_n_polygon_around_oldest_carbon(val);` の組み合わせで、すべて網羅できていそう。

### EPSILON について
　通常、浮動小数点の等値判定は、`fabs(a−b)≦DBL_EPSILON×a` で行う。  
　本シミュレーションでは、浮動小数点を固定小数点的に使用するためと、精度的には float で十分であることから、本シミュレーションでの浮動小数点の等値判定は、`fabs(a-b)≦FLT_EPSILON` で行う。  
　固有値計算では微小角度を表現する必要があるため、Quaternion.cc での角度0判定は `fabs(a-b)≦DBL_EPSILON` で行う。

### Euler 標数

* オイラーの閉曲面の分類定理

　g-重トーラスの Euler 標数は 2-2g である。平面の Euler 標数は 0 である。

### C60 の特徴
北南半球：五角形+五角形  
筒部：なし  
生成式：S1-5b6c5b6b5b  
五員環同士の距離分布：12,60,0,0,60,0,0,12

### C70 の特徴
北南半球：五角形+五角形  
筒部：アームチェア型x1.5  
生成式：S1-5b6d5b6b5b  
五員環同士の距離分布：12,40,10,20,20,20,20,0,2

### C72 の特徴
北南半球：六角形+六角形  
筒部：アームチェア型x1.0  
生成式：S3-5b6c5b6c  
五員環同士の距離分布：12,48,0,0,48,12,0,24

### C76-1 の特徴
四分半球：小三角形+小三角形+小三角形+小三角形  
筒部：なし  
生成式：S2-6c5b6c5b6b  
五員環同士の距離分布：12,40,10,20,20,20,20,0,2

### C78-1 の特徴
北南半球：大三角形+大三角形  
筒部：ジグザグ型(9個の六員環)x1  
生成式：S2-5b6c5b6c5b6b  
五員環同士の距離分布：12,42,0,0,48,18,0,24

### C78-3 の特徴
北南半球：小三角形+小三角形  
筒部：ジグザグ型(9個の六員環)x1  
生成式：A1-5b6b5b6b5b6b5b6e5b6g5b6f5c6b5b6b5b6c5b6c  
五員環同士の距離分布：12,36,6,18,24,18,18,6,6

### C78-4 の特徴
北南半球：六角形+日の字  
筒部：ジグザグ型(12個の六員環)x1  
生成式：A1-5b6b5b6b5b6b5b6k5b6c5c6b5b6f5b6c5c6b  
五員環同士の距離分布：12,34,8,16,28,18,8,20

### C80-1 の特徴
北南半球：五角形+五角形  
筒部：なし  
生成式：S1-6b5b6c5b6b5b  
五員環同士の距離分布：12,0,60,0,0,60,0,0,0,12

### C80-2 の特徴
北南半球：五角形+五角形  
筒部：アームチェア型(10個の六員環)x2  
生成式：S1-5b6e5b6b5b  
五員環同士の距離分布：12,40,0,20,20,20,20,0,10,2

----------------------------------------------------------

### C84-02 の特徴
北南半球：六角形+三菱  
筒部：俵積み型(12個の六員環)x1  
生成式：  
五員環同士の距離分布：

### C84-03 の特徴
北南半球：三菱+三菱  
筒部：なし  
生成式：S2-6b5b6b5b6b5b6c  
五員環同士の距離分布：

### C90-01 の特徴
北南半球：五角形+五角形  
筒部：俵積み型(5個の六員環)x3  
生成式：S1-5b6f5b6b5b  
五員環同士の距離分布：

### C96-04 の特徴
北南半球：大三角形+大三角形  
筒部：ガンベルト型(9個の六員環)x2  
生成式：S2-5b6f5b6b5b6b  
五員環同士の距離分布：

### C100-01 の特徴
北南半球：五角形+五角形  
筒部：俵積み型(5個の六員環)x4  
生成式：S1-5b6g5b6b5b  
五員環同士の距離分布：
